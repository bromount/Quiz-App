{% extends "dashBase.html" %}

{% block title %}VEC Quiz App{% endblock %}
{% block customCSS %}
<link rel="stylesheet" href="{{ url_for('static',filename='studDashboard.css') }}">
{% endblock %}
{% block dashContent %}
    <div class="sidebar">
        <div class="studBanner">
            <img src="{{ url_for('static',filename='VEC-logo.png') }}" alt="logo" class="clgLogo">
            <h6 class="studName">{{studName}}</h6>
        </div>
        <div class="d-flex">
            <input type="text" name="testCode" id="testCode" placeholder="TEST CODE" onkeydown="writeTest(this)">
            <button id="testButton" type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop">Go</button>
        </div>
        <a href=""class="active">Dash Board</a>
        <a href="{{ url_for('main.download_prev_result') }}">Download Previous Test Results</a>
        <a href="{{ url_for('main.edit_details') }}" class="active">Edit Your Details</a>
        <a href="{{ url_for('main.logout') }}" class="btn btn-danger">Logout</a>
     </div>

     <div class="content">
      <h4>Edit Your Details</h4>
      <div class="alert alert-info">
        Edit the below details if its not in this format
        <ol style="font-weight: bold;">
          <li>Student Name should be ending with thier initial (example: Vishvaa K)</li>
          <li>Student should update their University Registeration No in the Registeration number field</li>
          <li>Student should update a valid email if previous one is not correct</li>
          <li>Student must be updated like this (I-CSE-A). For Mech,EIE,AUTO please mention your class as (I-MECH-A) respectively</li>
          <li>After making changes to the fields, click sumbit button only once. (Don't click that repeatedly)</li>
        </ol>
      </div>


        <div class="edit-profile shadow p-3 mb-5 bg-body-tertiary rounded" style="width: 70%; text-align: center;">
          <form action="{{ url_for('main.edit_details') }}" method="POST" id="editDetailsForm">
            <div class="avatar d-flex justify-content-center align-items-center">
              <img src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png" alt="" width="150" height="150" style="border-radius: 50%;">
              <div><button type="button" class="btn btn-info btn-sm">Upload</button></div>
            </div>

            <div class="d-flex justify-content-md-evenly align-items-center">
              <div class="form-floating mt-3" style="width: 60%;">
                <input type="text" class="form-control" id="studName" name="studName" placeholder="Student Name" autocomplete="off">
                <label for="studName">Student Name</label>
              </div>
            </div>

            <div class="d-flex justify-content-evenly align-items-center">
              <div class="form-floating mt-3" style="width: 60%;">
                <input type="text" class="form-control" id="studRegno" name="studRegno" placeholder="Student Regno" autocomplete="off">
                <label for="studRegno">Student Registeration No</label>
              </div>
            </div>

            <div class="d-flex justify-content-evenly align-items-center">
              <div class="form-floating mt-3" style="width: 60%;">
                <input type="text" class="form-control" id="studClass" name="studClass" placeholder="Student Class" autocomplete="off" style="text-transform: uppercase
                ;">
                <label for="studClass">Student Class</label>
              </div>
            </div>

            <div class="d-flex justify-content-evenly align-items-center">
              <div class="form-floating mt-3" style="width: 60%;">
                <input type="email" class="form-control" id="studEmail" name="studEmail" placeholder="Student Email" autocomplete="off">
                <label for="studEmail">Student Email</label>
              </div>
            </div>
            <button type="submit" class="btn btn-success btn-lg" onclick="submitForm()">Submit</button>

          </form>
        </div>
     </div>
{% endblock %}

{% block customJS %}
<script>
  window.onload = () =>{
        const getUserDetailsUrl = "{{ url_for('main.get_user_details') }}";
        fetch(getUserDetailsUrl,{
          "method":'POST',
        }).then(response => response.json()).then(json=>{
                document.getElementById("studName").value = json['username'];
                document.getElementById("studRegno").value = json['regno'];
                document.getElementById("studClass").value = json['class'];
                document.getElementById("studEmail").value = json['email'];
        })
  }

  // submitForm=()=>{
  //   form = document.querySelector("#editDetailsForm");
  //   form.submit();
  //   form.reset();
  //   return false;
  // }

</script>
{% endblock %}